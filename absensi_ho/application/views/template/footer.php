<div class="footer">
    <div class="footer-inner">
        <!-- #section:basics/footer -->
        <div class="footer-content">
            <span class="bigger-120">
                <span class="blue bolder">MIPS</span>
                Absensi &copy; 2020
            </span>

            &nbsp; &nbsp;
            <!-- <span class="action-buttons">
                <a href="#">
                    <i class="ace-icon fa fa-twitter-square light-blue bigger-150"></i>
                </a>

                <a href="#">
                    <i class="ace-icon fa fa-facebook-square text-primary bigger-150"></i>
                </a>

                <a href="#">
                    <i class="ace-icon fa fa-rss-square orange bigger-150"></i>
                </a>
            </span> -->
        </div>

        <!-- /section:basics/footer -->
    </div>
</div>

<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
    <i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
</a>
</div><!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->
<script src="<?= base_url(); ?>assets/assets/js/jquery.js"></script>

<!-- <![endif]-->

<!--[if IE]>
<script src="../assets/js/jquery1x.js"></script>
<![endif]-->
<!-- <script type="text/javascript">
			if('ontouchstart' in document.documentElement) document.write("<script src='../assets/js/jquery.mobile.custom.js'>"+"<"+"/script>");
		</script> -->
<script src="<?= base_url(); ?>assets/assets/js/bootstrap.js"></script>

<!-- page specific plugin scripts -->

<!--[if lte IE 8]>
		  <script src="../assets/js/excanvas.js"></script>
		<![endif]-->
<script src="<?= base_url(); ?>assets/assets/js/jquery-ui.custom.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/jquery.ui.touch-punch.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/jquery.easypiechart.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/jquery.sparkline.js"></script>
<!-- <script src="<?= base_url(); ?>assets/assets/js/flot/jquery.flot.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/flot/jquery.flot.pie.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/flot/jquery.flot.resize.js"></script> -->
<script src="<?= base_url(); ?>assets/assets/js/chosen.jquery.js"></script>
<!-- <script src="<?= base_url(); ?>assets/assets/js/jquery.knob.js"></script> -->
<!-- <script src="<?= base_url(); ?>assets/assets/js/autosize.js"></script> -->
<!-- <script src="<?= base_url(); ?>assets/assets/js/jquery.inputlterimi.1.3.1.js"></script> -->
<script src="<?= base_url(); ?>assets/assets/js/jquery.maskedinput.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/bootstrap-tag.js"></script>

<!-- ace scripts -->
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.scroller.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.colorpicker.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.fileinput.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.typeahead.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.wysiwyg.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.spinner.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.treeview.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.wizard.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.aside.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.ajax-content.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.touch-drag.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.sidebar.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.sidebar-scroll-1.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.submenu-hover.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.widget-box.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.settings.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.settings-rtl.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.settings-skin.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.widget-on-reload.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.searchbox-autocomplete.js"></script>
<!-- page specific plugin scripts -->
<script src="<?= base_url(); ?>assets/assets/js/dataTables/jquery.dataTables.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/dataTables/jquery.dataTables.bootstrap.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/dataTables/extensions/Buttons/js/dataTables.buttons.js"></script>

<script src="<?= base_url(); ?>assets/assets/js/dataTables/extensions/Select/js/dataTables.select.js"></script>



<!-- the following scripts are used in demo only for onpage help and you don't need them -->
<link rel="stylesheet" href="<?= base_url(); ?>assets/assets/css/ace.onpage-help.css" />
<link rel="stylesheet" href="<?= base_url(); ?>assets/docs/assets/js/themes/sunburst.css" />
<link rel="stylesheet" href="<?= base_url(); ?>assets/assets/css/bootstrap-datepicker3.css" />
<script type="text/javascript">
    ace.vars['base'] = '..';
</script>
<script src="<?= base_url(); ?>assets/assets/js/ace/elements.onpage-help.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/ace/ace.onpage-help.js"></script>
<script src="<?= base_url(); ?>assets/docs/assets/js/rainbow.js"></script>
<script src="<?= base_url(); ?>assets/docs/assets/js/language/generic.js"></script>
<script src="<?= base_url(); ?>assets/docs/assets/js/language/html.js"></script>
<script src="<?= base_url(); ?>assets/docs/assets/js/language/css.js"></script>
<script src="<?= base_url(); ?>assets/docs/assets/js/language/javascript.js"></script>
<script src="<?= base_url(); ?>assets/assets/js/date-time/bootstrap-datepicker.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    $(document).ready(function() {
        $('.date-picker').datepicker({
            autoclose: true,
            todayHighlight: true
            // defaultDate: date,
        });
        // $(".date-picker").datepicker({ dateFormat: 'yy-mm-dd' });
        $(".date-picker").datepicker("setDate", new Date());

        var date_absen = $('#date_absen').val();
        list_absen_karyawan(date_absen);
        list_absen_karyawan_wfo(date_absen);
        list_summary(date_absen);
        var rel = setInterval(function() {
            last_seen();
        }, 1000);
        $('#tabpane_wfh').show();
        $('#tabpane_wfo').hide();
    });

    function mn_track() {
        swal('Maaf fitur ini masih dalam tahap pengembangan!', {
            icon: 'info'
        });
    }

    function mn_logout() {
        swal({
                text: "Anda yakin ingin keluar?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((willDelete) => {
                if (willDelete) {
                    window.location.replace('<?= site_url("login/logout"); ?>');
                }
            });
    }

    $('#wfh_tab').click(function() {
        $('#tabpane_wfh').show();
        $('#tabpane_wfo').hide();
        var rel = setInterval(function() {
            $('#laporan_excel').DataTable().ajax.reload();
            clearInterval(rel);
        }, 100);
    });
    $('#wfo_tab').click(function() {
        $('#tabpane_wfh').hide();
        $('#tabpane_wfo').show();
        var rel = setInterval(function() {
            $('#laporan_excel_wfo').DataTable().ajax.reload();
            clearInterval(rel);
        }, 100);
    });

    $('#date_absen').change(function() {
        var date_absen = $('#date_absen').val();
        // console.log(date_absen);
        list_absen_karyawan(date_absen);
        list_absen_karyawan_wfo(date_absen);
        list_summary(date_absen);
    });

    
    $('#date_absen_track').change(function() {
        var date_absen = $('#date_absen_track').val();
        console.log(date_absen);
        list_users(date_absen);
    });

    function list_absen_karyawan(date_absen) {
        $('#laporan_excel').dataTable().fnDestroy();
        $('#laporan_excel').dataTable({
            "paging": true,
            "scrollY": true,
            "scrollX": true,
            "searching": true,
            "select": false,
            "bLengthChange": true,
            "scrollCollapse": true,
            "bPaginate": true,
            "bInfo": true,
            "bSort": false,
            "processing": true,
            "serverSide": true,
            "order": [],
            "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {},
            "ajax": {
                "url": "<?php echo site_url('laporan/list_karyawan'); ?>",
                "type": "POST",
                "data": {
                    'date_absen': date_absen
                },
                "error": function(request) {
                    alert(request.responseText);
                    console.log(request.responseText);
                }
            },
            "columnDefs": [{
                "targets": [],
                "orderable": false,
            }, ],
        });
        var rel = setInterval(function() {
            $('#laporan_excel').DataTable().ajax.reload();
            clearInterval(rel);
        }, 100);
    }

    function list_absen_karyawan_wfo(date_absen) {
        $('#laporan_excel_wfo').dataTable().fnDestroy();
        $('#laporan_excel_wfo').dataTable({
            "paging": true,
            "scrollY": true,
            "scrollX": true,
            "searching": true,
            "select": false,
            "bLengthChange": true,
            "scrollCollapse": true,
            "bPaginate": true,
            "bInfo": true,
            "bSort": false,
            "processing": true,
            "serverSide": true,
            "order": [],
            "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {},
            "ajax": {
                "url": "<?php echo site_url('laporan/list_karyawan_wfo'); ?>",
                "type": "POST",
                "data": {
                    'date_absen': date_absen
                },
                "error": function(request) {
                    alert(request.responseText);
                    console.log(request.responseText);
                }
            },
            "columnDefs": [{
                "targets": [],
                "orderable": false,
            }, ],
        });
        var rel = setInterval(function() {
            $('#laporan_excel_wfo').DataTable().ajax.reload();
            clearInterval(rel);
        }, 100);
    }

    function list_summary(date_absen) {
        $.ajax({
            type: "POST",
            url: "<?php echo site_url('laporan/list_summary'); ?>",
            dataType: "JSON",
            beforeSend: function() {},
            cache: false,
            data: {
                'date_absen': date_absen,
            },
            success: function(data) {
                $('#jml_kr').html(data.jml_kr);
                $('#jml_wfh').html(data.jml_wfh);
                $('#jml_wfo').html(data.jml_wfo);
                $('#ket_sakit').html(data.ket_sakit);
                $('#ket_izin').html(data.ket_izin);
                $('#ket_cuti').html(data.ket_cuti);
            },
            error: function(request) {
                console.log(request.responseText);
            }
        });
    }

    function last_seen() {
        $.ajax({
            type: "POST",
            url: "<?php echo site_url('administrator/last_seen'); ?>",
            dataType: "JSON",
            beforeSend: function() {},
            cache: false,
            data: {
                'id_user': '<?= $this->session->userdata("id_admin"); ?>',
            },
            success: function(data) {
                $('#last_seen').html('<span class="label label-pink arrowed-in-right"><i class="ace-icon fa fa-circle smaller-80 align-middle"></i> Online</span>')
            },
            error: function(request) {
                $('#last_seen').html('<span class="label label-green arrowed-in-right"><i class="ace-icon fa fa-circle smaller-80 align-middle"></i> Offline </span>')
                // console.log(request.responseText);
            }
        });
    }


    $('#btn_print').click(function() {
        var pilih_bulan = $('#pilih_bulan').val();
        window.open('<?= site_url("laporan/print_lap"); ?>/' + pilih_bulan);
    });
</script>
</body>

</html>